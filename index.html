<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeamChat ¬∑ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600;14..32,700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }
        body {
            background: #0a0c14;
            color: white;
            overflow: hidden;
        }
        .app {
            display: flex;
            height: 100vh;
            width: 100vw;
        }
        /* –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é */
        .sidebar {
            width: 300px;
            background: #121b30;
            border-right: 1px solid #253153;
            display: flex;
            flex-direction: column;
        }
        .profile-header {
            padding: 20px;
            border-bottom: 1px solid #253153;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .avatar {
            width: 54px;
            height: 54px;
            background: linear-gradient(145deg, #2b4b9e, #1f3a7a);
            border-radius: 40%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 600;
        }
        .user-info h3 {
            font-size: 1.1rem;
            color: white;
        }
        .user-info p {
            font-size: 0.8rem;
            color: #8a9fd1;
        }
        .vip-badge {
            background: gold;
            color: #0a0c14;
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 700;
            display: inline-block;
            margin-top: 4px;
        }
        .nav-menu {
            flex: 1;
            padding: 20px 0;
        }
        .nav-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 14px 25px;
            color: #a7b9f0;
            cursor: pointer;
            transition: 0.2s;
        }
        .nav-item:hover, .nav-item.active {
            background: #1f2b4a;
            color: white;
            border-left: 3px solid #4f7ae0;
        }
        .badge {
            background: #bf4b4b;
            color: white;
            border-radius: 30px;
            padding: 2px 8px;
            font-size: 0.7rem;
            margin-left: auto;
        }
        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .content-header {
            padding: 20px 30px;
            background: #121b30;
            border-bottom: 1px solid #253153;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .content-header h2 {
            font-size: 1.8rem;
            color: white;
        }
        .content-body {
            flex: 1;
            overflow-y: auto;
            padding: 20px 30px;
        }
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            padding: 10px 20px;
            border-radius: 30px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
        }
        .btn-primary {
            background: #2b4b9e;
            color: white;
        }
        .btn-primary:hover {
            background: #3d62c0;
        }
        .btn-secondary {
            background: #2f3d66;
            color: white;
        }
        .btn-success {
            background: #2e7d32;
            color: white;
        }
        .btn-danger {
            background: #8b2e2e;
            color: white;
        }
        /* –°–ø–∏—Å–∫–∏ */
        .chats-list, .contacts-list, .channels-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .chat-item, .contact-item, .channel-item {
            background: #1a2440;
            border-radius: 28px;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            border: 1px solid #2f3d66;
            transition: 0.2s;
        }
        .chat-item:hover, .contact-item:hover, .channel-item:hover {
            background: #223052;
            border-color: #4f7ae0;
        }
        .chat-avatar, .contact-avatar, .channel-avatar {
            width: 56px;
            height: 56px;
            background: #2b3e7a;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
        }
        .chat-info, .contact-info, .channel-info {
            flex: 1;
        }
        .chat-name, .contact-name, .channel-name {
            font-weight: 600;
            font-size: 1.1rem;
            color: white;
        }
        .chat-last, .contact-status, .channel-subscribers {
            color: #8a9fd1;
            font-size: 0.9rem;
        }
        .unread {
            background: #4f7ae0;
            border-radius: 30px;
            padding: 4px 10px;
            font-size: 0.8rem;
            color: white;
        }
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-content {
            background: #1a2440;
            border-radius: 48px;
            padding: 40px;
            min-width: 450px;
            border: 2px solid #4f7ae0;
        }
        .modal-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
            color: white;
        }
        .modal-input {
            width: 100%;
            background: #1f294a;
            border: 1px solid #314a7a;
            border-radius: 40px;
            padding: 15px 20px;
            color: white;
            margin-bottom: 15px;
            outline: none;
        }
        .modal-input:focus {
            border-color: #5f8aff;
        }
        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        .hidden {
            display: none !important;
        }
        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .message {
            max-width: 70%;
            display: flex;
            flex-direction: column;
        }
        .message.outgoing {
            align-self: flex-end;
        }
        .message-bubble {
            padding: 12px 18px;
            border-radius: 24px;
            background: #262f50;
            color: white;
        }
        .message.outgoing .message-bubble {
            background: #2b4b9e;
        }
        .message-footer {
            display: flex;
            gap: 10px;
            margin-top: 4px;
            font-size: 0.8rem;
            color: #8a9fd1;
        }
        .reaction {
            cursor: pointer;
            padding: 2px 6px;
            background: #1f294a;
            border-radius: 20px;
            color: white;
        }
        .message-input-area {
            display: flex;
            gap: 10px;
            padding: 20px;
            background: #121b30;
        }
        .message-input {
            flex: 1;
            background: #1f294a;
            border: 1px solid #314a7a;
            border-radius: 40px;
            padding: 15px 20px;
            color: white;
            outline: none;
        }
        /* –ü–æ–¥–∞—Ä–∫–∏ */
        .gifts-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .gift-card {
            background: #1f2a48;
            border-radius: 24px;
            padding: 20px;
            text-align: center;
            border: 1px solid #3e5a9c;
            color: white;
        }
        .gift-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-section {
            background: #1a2440;
            border-radius: 32px;
            padding: 30px;
            margin-bottom: 20px;
        }
        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #2a3a60;
            color: white;
        }
        .settings-row:last-child {
            border-bottom: none;
        }
        .twofa-enabled {
            color: #4cd964;
            font-weight: 600;
        }
        .stat-value {
            color: #ffd966;
            font-weight: 600;
        }
        /* –ü–æ–∏—Å–∫ */
        .search-input {
            width: 100%;
            background: #1f294a;
            border: 1px solid #314a7a;
            border-radius: 40px;
            padding: 12px 20px;
            color: white;
            margin-bottom: 20px;
            outline: none;
        }
        .empty-state {
            text-align: center;
            color: #8a9fd1;
            padding: 60px 20px;
            background: #1a2440;
            border-radius: 32px;
        }
    </style>
</head>
<body>
    <div class="app" id="app">
        <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
        <div class="sidebar" id="sidebar">
            <div class="profile-header" id="profileBtn">
                <div class="avatar" id="avatar">‚ö°</div>
                <div class="user-info">
                    <h3 id="displayName">–ì–æ—Å—Ç—å</h3>
                    <p id="displayEmail">–Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω</p>
                    <span class="vip-badge hidden" id="vipBadge">VIP</span>
                </div>
            </div>
            <div class="nav-menu">
                <div class="nav-item active" data-view="chats">
                    <span>üí¨</span> –ß–∞—Ç—ã
                    <span class="badge" id="chatsBadge">0</span>
                </div>
                <div class="nav-item" data-view="contacts">
                    <span>üë•</span> –ö–æ–Ω—Ç–∞–∫—Ç—ã
                </div>
                <div class="nav-item" data-view="channels">
                    <span>üì¢</span> –ö–∞–Ω–∞–ª—ã
                </div>
                <div class="nav-item" data-view="gifts">
                    <span>üéÅ</span> –ü–æ–¥–∞—Ä–∫–∏
                </div>
                <div class="nav-item" data-view="vip">
                    <span>üëë</span> VIP –ø–æ–¥–ø–∏—Å–∫–∞
                </div>
                <div class="nav-item" data-view="settings">
                    <span>‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content" id="mainContent">
            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–≤—Ö–æ–¥–∞ -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-title" id="authTitle">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
            <input type="text" class="modal-input" id="regUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            <input type="email" class="modal-input" id="regEmail" placeholder="–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞">
            <input type="password" class="modal-input" id="regPassword" placeholder="–ü–∞—Ä–æ–ª—å">
            <input type="password" class="modal-input" id="regConfirm" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è">
            <div class="modal-buttons">
                <button class="btn btn-primary" id="registerBtn" style="flex:1;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <button class="btn btn-secondary" id="switchToLoginBtn">–í–æ–π—Ç–∏</button>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-secondary" id="guestBtn">–í–æ–π—Ç–∏ –∫–∞–∫ –≥–æ—Å—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞ -->
    <div class="modal hidden" id="createChatModal">
        <div class="modal-content">
            <div class="modal-title">–°–æ–∑–¥–∞—Ç—å —á–∞—Ç</div>
            <select class="modal-input" id="chatType">
                <option value="private">–õ–∏—á–Ω—ã–π —á–∞—Ç</option>
                <option value="group">–ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç</option>
            </select>
            <input type="text" class="modal-input" id="chatName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞">
            <div class="modal-buttons">
                <button class="btn btn-primary" id="createChatConfirm">–°–æ–∑–¥–∞—Ç—å</button>
                <button class="btn btn-secondary" id="closeCreateChat">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–Ω–∞–ª–∞ -->
    <div class="modal hidden" id="createChannelModal">
        <div class="modal-content">
            <div class="modal-title">–°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª</div>
            <input type="text" class="modal-input" id="channelName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞">
            <textarea class="modal-input" id="channelDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞" rows="3"></textarea>
            <div class="modal-buttons">
                <button class="btn btn-primary" id="createChannelConfirm">–°–æ–∑–¥–∞—Ç—å</button>
                <button class="btn btn-secondary" id="closeCreateChannel">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥–∞—Ä–∫–æ–≤ -->
    <div class="modal hidden" id="giftModal">
        <div class="modal-content">
            <div class="modal-title">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∞—Ä–æ–∫</div>
            <div class="gifts-grid" id="giftsGrid"></div>
            <button class="btn btn-secondary" id="closeGiftModal">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        // ==================== –î–ê–ù–ù–´–ï ====================
        const BeamChat = {
            currentUser: null,
            state: {
                currentView: 'chats',
                activeChat: null,
                activeChannel: null
            },
            db: {
                users: [],
                chats: [],
                channels: [],
                contacts: [],
                messages: {},
                gifts: [
                    { id: 1, name: 'üíé –ê–ª–º–∞–∑', price: 50, icon: 'üíé' },
                    { id: 2, name: 'üåπ –†–æ–∑–∞', price: 10, icon: 'üåπ' },
                    { id: 3, name: 'üöÄ –†–∞–∫–µ—Ç–∞', price: 100, icon: 'üöÄ' },
                    { id: 4, name: 'üëë –ö–æ—Ä–æ–Ω–∞ VIP', price: 200, icon: 'üëë', vipOnly: true },
                    { id: 5, name: 'üéÇ –¢–æ—Ä—Ç', price: 75, icon: 'üéÇ' },
                    { id: 6, name: 'üêª –ú–∏—à–∫–∞', price: 30, icon: 'üêª' }
                ]
            }
        };

        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        BeamChat.db.chats = [
            { id: 1, name: '–ê–Ω–Ω–∞ –°–≤–µ—Ç–ª–æ–≤–∞', type: 'private', avatar: '–ê', lastMsg: '–ü—Ä–∏–≤–µ—Ç!', time: '10:30', unread: 2 },
            { id: 2, name: '–ö–æ–º–∞–Ω–¥–∞ Beam', type: 'group', avatar: 'üë•', lastMsg: '–í—Å—Ç—Ä–µ—á–∞ –≤ 15:00', time: '–í—á–µ—Ä–∞', unread: 0 },
            { id: 3, name: '–ù–æ–≤–æ—Å—Ç–∏ Beam', type: 'channel', avatar: 'üì¢', lastMsg: '–†–µ–ª–∏–∑ 2.0', time: '12:45', unread: 5 }
        ];

        BeamChat.db.channels = [
            { id: 101, name: 'Beam Official', avatar: 'üì°', subscribers: 1250, isSubscribed: true },
            { id: 102, name: '–ò–≥—Ä–æ–≤–æ–π –º–∏—Ä', avatar: 'üéÆ', subscribers: 540, isSubscribed: false }
        ];

        BeamChat.db.contacts = [
            { id: 1, name: '–ê–Ω–Ω–∞ –°–≤–µ—Ç–ª–æ–≤–∞', status: 'online', avatar: '–ê', subscribers: 120 },
            { id: 2, name: '–î–º–∏—Ç—Ä–∏–π –í–æ–ª–∫–æ–≤', status: 'offline', avatar: '–î', subscribers: 45 },
            { id: 3, name: '–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞ –õ—É—á', status: 'online', avatar: '–ï', subscribers: 230 }
        ];

        BeamChat.db.messages = {
            1: [
                { id: 1, text: '–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?', time: '10:30', outgoing: false, reactions: [] },
                { id: 2, text: '–û—Ç–ª–∏—á–Ω–æ! –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ', time: '10:32', outgoing: true, reactions: [] }
            ],
            2: [
                { id: 1, text: '–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç –≤ –≥—Ä—É–ø–ø–µ', time: '09:15', outgoing: false, reactions: ['üëç'] }
            ],
            3: [
                { id: 1, text: '–í—ã—à–µ–ª –Ω–æ–≤—ã–π —Ä–µ–ª–∏–∑', time: '12:45', outgoing: false, reactions: ['üî•', 'üëç'] }
            ]
        };

        // ==================== UI –≠–õ–ï–ú–ï–ù–¢–´ ====================
        const mainContent = document.getElementById('mainContent');
        const authModal = document.getElementById('authModal');
        const createChatModal = document.getElementById('createChatModal');
        const createChannelModal = document.getElementById('createChannelModal');
        const giftModal = document.getElementById('giftModal');
        const displayName = document.getElementById('displayName');
        const displayEmail = document.getElementById('displayEmail');
        const avatar = document.getElementById('avatar');
        const vipBadge = document.getElementById('vipBadge');
        const chatsBadge = document.getElementById('chatsBadge');

        // ==================== –§–£–ù–ö–¶–ò–ò ====================
        function updateUI() {
            if (BeamChat.currentUser) {
                displayName.textContent = BeamChat.currentUser.username;
                displayEmail.textContent = BeamChat.currentUser.email || '–Ω–µ—Ç –ø–æ—á—Ç—ã';
                avatar.textContent = BeamChat.currentUser.username.charAt(0).toUpperCase();
                if (BeamChat.currentUser.isVip) {
                    vipBadge.classList.remove('hidden');
                } else {
                    vipBadge.classList.add('hidden');
                }
            } else {
                displayName.textContent = '–ì–æ—Å—Ç—å';
                displayEmail.textContent = '–Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω';
                avatar.textContent = '‚ö°';
                vipBadge.classList.add('hidden');
            }
            
            const unreadCount = BeamChat.db.chats.reduce((sum, chat) => sum + (chat.unread || 0), 0);
            chatsBadge.textContent = unreadCount || '0';
        }

        function showView(view) {
            BeamChat.state.currentView = view;
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.view === view) item.classList.add('active');
            });
            renderMainContent();
        }

        function renderMainContent() {
            const view = BeamChat.state.currentView;
            mainContent.innerHTML = '';

            switch(view) {
                case 'chats': renderChats(); break;
                case 'contacts': renderContacts(); break;
                case 'channels': renderChannels(); break;
                case 'gifts': renderGifts(); break;
                case 'vip': renderVIP(); break;
                case 'settings': renderSettings(); break;
                default: renderChats();
            }
        }

        // ==================== –ß–ê–¢–´ ====================
        function renderChats() {
            if (BeamChat.state.activeChat) {
                renderChatWindow(BeamChat.state.activeChat);
                return;
            }

            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>–ß–∞—Ç—ã</h2>
                    <button class="btn btn-primary" id="createChatBtn">‚ûï –°–æ–∑–¥–∞—Ç—å —á–∞—Ç</button>
                    <button class="btn btn-primary" id="createChannelBtn">üì¢ –°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª</button>
                </div>
                <div class="content-body">
                    <input type="text" class="search-input" id="searchChats" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ —á–∞—Ç–∞–º...">
                    <div class="chats-list" id="chatsList"></div>
                </div>
            `;

            const chatsList = document.getElementById('chatsList');
            renderChatsList(chatsList, BeamChat.db.chats);

            document.getElementById('createChatBtn').addEventListener('click', () => {
                createChatModal.classList.remove('hidden');
            });

            document.getElementById('createChannelBtn').addEventListener('click', () => {
                createChannelModal.classList.remove('hidden');
            });

            document.getElementById('searchChats').addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                const filtered = BeamChat.db.chats.filter(chat => 
                    chat.name.toLowerCase().includes(query)
                );
                renderChatsList(chatsList, filtered);
            });
        }

        function renderChatsList(container, chats) {
            container.innerHTML = '';
            
            if (chats.length === 0) {
                container.innerHTML = '<div class="empty-state">–ß–∞—Ç–æ–≤ –Ω–µ—Ç. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π!</div>';
                return;
            }

            chats.forEach(chat => {
                const item = document.createElement('div');
                item.className = 'chat-item';
                item.innerHTML = `
                    <div class="chat-avatar">${chat.avatar}</div>
                    <div class="chat-info">
                        <div class="chat-name">${chat.name}</div>
                        <div class="chat-last">${chat.lastMsg || '–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π'} ¬∑ ${chat.time || ''}</div>
                    </div>
                    ${chat.unread > 0 ? `<span class="unread">${chat.unread}</span>` : ''}
                `;
                item.addEventListener('click', () => {
                    BeamChat.state.activeChat = chat.id;
                    renderChats();
                });
                container.appendChild(item);
            });
        }

        function renderChatWindow(chatId) {
            const chat = BeamChat.db.chats.find(c => c.id === chatId);
            if (!chat) return;

            mainContent.innerHTML = `
                <div class="content-header">
                    <button class="btn btn-secondary" id="backBtn">‚Üê –ù–∞–∑–∞–¥</button>
                    <h2>${chat.name}</h2>
                    <button class="btn btn-primary" id="chatSettingsBtn">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </div>
                <div class="messages-container" id="messages"></div>
                <div class="message-input-area">
                    <input type="text" class="message-input" id="messageInput" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ...">
                    <button class="btn btn-primary" id="sendBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            `;

            const messages = BeamChat.db.messages[chatId] || [];
            const messagesDiv = document.getElementById('messages');
            
            if (messages.length === 0) {
                messagesDiv.innerHTML = '<div class="empty-state">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π. –ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å!</div>';
            } else {
                messages.forEach(msg => {
                    const msgDiv = document.createElement('div');
                    msgDiv.className = `message ${msg.outgoing ? 'outgoing' : 'incoming'}`;
                    msgDiv.innerHTML = `
                        <div class="message-bubble">${msg.text}</div>
                        <div class="message-footer">
                            <span>${msg.time}</span>
                            <div>
                                ${(msg.reactions || []).map(r => `<span class="reaction" onclick="addReaction(${chatId}, ${msg.id}, '${r}')">${r}</span>`).join('')}
                                <span class="reaction" onclick="showReactionPicker(${chatId}, ${msg.id})">‚ûï</span>
                            </div>
                        </div>
                    `;
                    messagesDiv.appendChild(msgDiv);
                });
            }

            document.getElementById('sendBtn').addEventListener('click', () => {
                const input = document.getElementById('messageInput');
                if (!input.value.trim()) return;
                
                const newMsg = {
                    id: Date.now(),
                    text: input.value,
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    outgoing: true,
                    reactions: []
                };
                
                if (!BeamChat.db.messages[chatId]) BeamChat.db.messages[chatId] = [];
                BeamChat.db.messages[chatId].push(newMsg);
                chat.lastMsg = input.value;
                chat.time = '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
                
                renderChatWindow(chatId);
            });

            document.getElementById('backBtn').addEventListener('click', () => {
                BeamChat.state.activeChat = null;
                renderChats();
            });

            document.getElementById('chatSettingsBtn').addEventListener('click', () => {
                showChatSettings(chat);
            });
        }

        function showChatSettings(chat) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞</div>
                    <p style="color:white; margin-bottom:10px;">–ù–∞–∑–≤–∞–Ω–∏–µ: ${chat.name}</p>
                    <p style="color:white; margin-bottom:10px;">–¢–∏–ø: ${chat.type === 'private' ? '–õ–∏—á–Ω—ã–π' : '–ì—Ä—É–ø–ø–æ–≤–æ–π'}</p>
                    <input type="text" id="newChatName" class="modal-input" placeholder="–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" value="${chat.name}">
                    <div class="modal-buttons">
                        <button class="btn btn-primary" id="renameChatBtn">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-danger" id="deleteChatBtn">–£–¥–∞–ª–∏—Ç—å —á–∞—Ç</button>
                        <button class="btn btn-secondary" id="closeModal">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            document.getElementById('renameChatBtn').addEventListener('click', () => {
                const newName = document.getElementById('newChatName').value.trim();
                if (newName) {
                    chat.name = newName;
                    modal.remove();
                    renderChatWindow(chat.id);
                }
            });

            document.getElementById('deleteChatBtn').addEventListener('click', () => {
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —á–∞—Ç?')) {
                    const index = BeamChat.db.chats.findIndex(c => c.id === chat.id);
                    if (index !== -1) BeamChat.db.chats.splice(index, 1);
                    delete BeamChat.db.messages[chat.id];
                    modal.remove();
                    BeamChat.state.activeChat = null;
                    renderChats();
                }
            });

            document.getElementById('closeModal').addEventListener('click', () => modal.remove());
        }

        // ==================== –ö–û–ù–¢–ê–ö–¢–´ ====================
        function renderContacts() {
            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
                    <button class="btn btn-primary" id="addContactBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div class="content-body">
                    <input type="text" class="search-input" id="searchContacts" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤...">
                    <div class="contacts-list" id="contactsList"></div>
                </div>
            `;

            const contactsList = document.getElementById('contactsList');
            renderContactsList(contactsList, BeamChat.db.contacts);

            document.getElementById('addContactBtn').addEventListener('click', () => {
                const name = prompt('–ò–º—è –∫–æ–Ω—Ç–∞–∫—Ç–∞:');
                if (name) {
                    BeamChat.db.contacts.push({
                        id: Date.now(),
                        name: name,
                        status: 'offline',
                        avatar: name.charAt(0),
                        subscribers: 0
                    });
                    renderContacts();
                }
            });

            document.getElementById('searchContacts').addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                const filtered = BeamChat.db.contacts.filter(c => 
                    c.name.toLowerCase().includes(query)
                );
                renderContactsList(contactsList, filtered);
            });
        }

        function renderContactsList(container, contacts) {
            container.innerHTML = '';
            
            contacts.forEach(contact => {
                const item = document.createElement('div');
                item.className = 'contact-item';
                item.innerHTML = `
                    <div class="contact-avatar">${contact.avatar}</div>
                    <div class="contact-info">
                        <div class="contact-name">${contact.name}</div>
                        <div class="contact-status">
                            ${contact.status === 'online' ? '‚óè –í —Å–µ—Ç–∏' : '‚óã –ù–µ –≤ —Å–µ—Ç–∏'}
                            ¬∑ –ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: ${contact.subscribers || 0}
                        </div>
                    </div>
                    <div style="display:flex; gap:5px;">
                        <button class="btn btn-primary" data-id="${contact.id}" data-action="chat">üí¨</button>
                        <button class="btn btn-secondary" data-id="${contact.id}" data-action="subscribe">üîî</button>
                        <button class="btn btn-secondary" data-id="${contact.id}" data-action="gift">üéÅ</button>
                    </div>
                `;
                
                item.querySelector('[data-action="chat"]').addEventListener('click', (e) => {
                    e.stopPropagation();
                    const newChat = {
                        id: Date.now(),
                        name: contact.name,
                        type: 'private',
                        avatar: contact.avatar,
                        lastMsg: '–ù–æ–≤—ã–π —á–∞—Ç',
                        time: '—Ç–æ–ª—å–∫–æ —á—Ç–æ',
                        unread: 0
                    };
                    BeamChat.db.chats.push(newChat);
                    BeamChat.db.messages[newChat.id] = [];
                    showView('chats');
                });
                
                item.querySelector('[data-action="subscribe"]').addEventListener('click', (e) => {
                    e.stopPropagation();
                    contact.subscribers = (contact.subscribers || 0) + 1;
                    if (BeamChat.currentUser) {
                        BeamChat.currentUser.subscribers = (BeamChat.currentUser.subscribers || 0) + 1;
                    }
                    renderContacts();
                });
                
                item.querySelector('[data-action="gift"]').addEventListener('click', (e) => {
                    e.stopPropagation();
                    openGiftModal(contact);
                });
                
                container.appendChild(item);
            });
        }

        // ==================== –ö–ê–ù–ê–õ–´ ====================
        function renderChannels() {
            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>–ö–∞–Ω–∞–ª—ã</h2>
                    <button class="btn btn-primary" id="createChannelBtn">üì¢ –°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª</button>
                </div>
                <div class="content-body">
                    <div class="channels-list" id="channelsList"></div>
                </div>
            `;

            const channelsList = document.getElementById('channelsList');
            BeamChat.db.channels.forEach(channel => {
                const item = document.createElement('div');
                item.className = 'channel-item';
                item.innerHTML = `
                    <div class="channel-avatar">${channel.avatar}</div>
                    <div class="channel-info">
                        <div class="channel-name">${channel.name}</div>
                        <div class="channel-subscribers">üë• ${channel.subscribers} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div>
                    </div>
                    <button class="btn btn-${channel.isSubscribed ? 'secondary' : 'primary'}" data-id="${channel.id}">
                        ${channel.isSubscribed ? '‚úÖ –ü–æ–¥–ø–∏—Å–∞–Ω' : 'üîî –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è'}
                    </button>
                    <button class="btn btn-secondary" data-id="${channel.id}" data-action="settings">‚öôÔ∏è</button>
                `;
                
                item.querySelector('button:first-of-type').addEventListener('click', (e) => {
                    e.stopPropagation();
                    channel.isSubscribed = !channel.isSubscribed;
                    if (channel.isSubscribed) {
                        channel.subscribers++;
                    } else {
                        channel.subscribers--;
                    }
                    renderChannels();
                });
                
                item.querySelector('[data-action="settings"]').addEventListener('click', (e) => {
                    e.stopPropagation();
                    showChannelSettings(channel);
                });
                
                item.addEventListener('click', () => {
                    const channelChat = BeamChat.db.chats.find(c => c.id === channel.id);
                    if (channelChat) {
                        BeamChat.state.activeChat = channelChat.id;
                        renderChats();
                    }
                });
                
                channelsList.appendChild(item);
            });

            document.getElementById('createChannelBtn').addEventListener('click', () => {
                createChannelModal.classList.remove('hidden');
            });
        }

        function showChannelSettings(channel) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–Ω–∞–ª–∞</div>
                    <p style="color:white; margin-bottom:10px;">–ù–∞–∑–≤–∞–Ω–∏–µ: ${channel.name}</p>
                    <p style="color:white; margin-bottom:10px;">–ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: ${channel.subscribers}</p>
                    <input type="text" id="newChannelName" class="modal-input" placeholder="–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" value="${channel.name}">
                    <div class="modal-buttons">
                        <button class="btn btn-primary" id="renameChannelBtn">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-danger" id="deleteChannelBtn">–£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª</button>
                        <button class="btn btn-secondary" id="closeModal">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            document.getElementById('renameChannelBtn').addEventListener('click', () => {
                const newName = document.getElementById('newChannelName').value.trim();
                if (newName) {
                    channel.name = newName;
                    const channelChat = BeamChat.db.chats.find(c => c.id === channel.id);
                    if (channelChat) channelChat.name = newName;
                    modal.remove();
                    renderChannels();
                }
            });

            document.getElementById('deleteChannelBtn').addEventListener('click', () => {
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–∞–Ω–∞–ª?')) {
                    const index = BeamChat.db.channels.findIndex(c => c.id === channel.id);
                    if (index !== -1) BeamChat.db.channels.splice(index, 1);
                    
                    const chatIndex = BeamChat.db.chats.findIndex(c => c.id === channel.id);
                    if (chatIndex !== -1) BeamChat.db.chats.splice(chatIndex, 1);
                    
                    delete BeamChat.db.messages[channel.id];
                    modal.remove();
                    renderChannels();
                }
            });

            document.getElementById('closeModal').addEventListener('click', () => modal.remove());
        }

        // ==================== –ü–û–î–ê–†–ö–ò ====================
        function renderGifts() {
            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>üéÅ –ú–∞–≥–∞–∑–∏–Ω –ø–æ–¥–∞—Ä–∫–æ–≤</h2>
                    <div style="background:#1f294a; padding:10px 20px; border-radius:40px;">
                        üí∞ ${BeamChat.currentUser?.coins || 0} –º–æ–Ω–µ—Ç
                    </div>
                </div>
                <div class="content-body">
                    <div class="gifts-grid">
                        ${BeamChat.db.gifts.map(gift => `
                            <div class="gift-card">
                                <div class="gift-icon">${gift.icon}</div>
                                <div style="font-weight:600;">${gift.name}</div>
                                <div style="color:#ffd966; margin:10px 0;">${gift.price}üí∞</div>
                                ${gift.vipOnly ? '<div style="color:gold;">üëë VIP</div>' : ''}
                                <button class="btn btn-primary" data-gift='${JSON.stringify(gift)}' style="margin-top:10px;">–ö—É–ø–∏—Ç—å</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            document.querySelectorAll('[data-gift]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const gift = JSON.parse(e.target.dataset.gift);
                    buyGift(gift);
                });
            });
        }

        function buyGift(gift) {
            if (!BeamChat.currentUser) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É');
                authModal.classList.remove('hidden');
                return;
            }
            
            if (gift.vipOnly && !BeamChat.currentUser.isVip) {
                alert('–≠—Ç–æ—Ç –ø–æ–¥–∞—Ä–æ–∫ —Ç–æ–ª—å–∫–æ –¥–ª—è VIP');
                return;
            }
            
            if (BeamChat.currentUser.coins < gift.price) {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç');
                return;
            }
            
            BeamChat.currentUser.coins -= gift.price;
            alert(`–ü–æ–¥–∞—Ä–æ–∫ ${gift.name} –∫—É–ø–ª–µ–Ω!`);
            renderGifts();
        }

        function openGiftModal(contact) {
            const grid = document.getElementById('giftsGrid');
            grid.innerHTML = BeamChat.db.gifts.map(gift => `
                <div class="gift-card">
                    <div class="gift-icon">${gift.icon}</div>
                    <div>${gift.name}</div>
                    <div>${gift.price}üí∞</div>
                    <button class="btn btn-primary" onclick="sendGift(${contact.id}, ${gift.id})">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            `).join('');
            
            giftModal.classList.remove('hidden');
        }

        window.sendGift = function(contactId, giftId) {
            const contact = BeamChat.db.contacts.find(c => c.id === contactId);
            const gift = BeamChat.db.gifts.find(g => g.id === giftId);
            
            if (!BeamChat.currentUser) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É');
                return;
            }
            
            if (BeamChat.currentUser.coins >= gift.price) {
                BeamChat.currentUser.coins -= gift.price;
                alert(`–ü–æ–¥–∞—Ä–æ–∫ ${gift.name} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω ${contact.name}!`);
                giftModal.classList.add('hidden');
            } else {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç');
            }
        };

        // ==================== VIP ====================
        function renderVIP() {
            const isVip = BeamChat.currentUser?.isVip || false;
            
            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>üëë VIP –ü–æ–¥–ø–∏—Å–∫–∞</h2>
                </div>
                <div class="content-body">
                    ${isVip ? `
                        <div style="background: linear-gradient(145deg, #2a3f7a, #1c2b5a); border-radius: 32px; padding: 40px; text-align: center; margin-bottom: 30px; border: 2px solid gold;">
                            <div style="font-size: 5rem;">üëë</div>
                            <h3 style="font-size: 2rem; margin:20px 0; color:white;">–í—ã VIP!</h3>
                            <p style="color:#ffd966;">–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É</p>
                        </div>
                    ` : `
                        <div style="background: #1a2440; border-radius: 32px; padding: 40px; text-align: center; margin-bottom: 30px;">
                            <div style="font-size: 5rem;">‚ú®</div>
                            <h3 style="margin:20px 0; color:white;">–°—Ç–∞–Ω—å—Ç–µ VIP</h3>
                            <p style="color:#8a9fd1; margin-bottom:30px;">–ü–æ–ª—É—á–∏—Ç–µ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
                            <button class="btn btn-primary" id="buyVipBtn" style="font-size:1.2rem; padding:15px 40px;">–ö—É–ø–∏—Ç—å VIP –∑–∞ 150üí∞</button>
                        </div>
                    `}
                    
                    <div style="background: #1a2440; border-radius: 24px; padding: 25px;">
                        <h3 style="margin-bottom:20px; color:white;">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ VIP</h3>
                        <ul style="list-style: none; color:#b5d0ff;">
                            <li style="margin:10px 0;">‚úì –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏</li>
                            <li style="margin:10px 0;">‚úì –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∑–Ω–∞—á–æ–∫ –≤ –ø—Ä–æ—Ñ–∏–ª–µ</li>
                            <li style="margin:10px 0;">‚úì 100 –º–æ–Ω–µ—Ç –µ–∂–µ–º–µ—Å—è—á–Ω–æ</li>
                            <li style="margin:10px 0;">‚úì –†–∞–Ω–Ω–∏–π –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º</li>
                        </ul>
                    </div>
                </div>
            `;

            const buyBtn = document.getElementById('buyVipBtn');
            if (buyBtn) {
                buyBtn.addEventListener('click', () => {
                    if (!BeamChat.currentUser) {
                        alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É');
                        authModal.classList.remove('hidden');
                        return;
                    }
                    
                    if (BeamChat.currentUser.coins >= 150) {
                        BeamChat.currentUser.coins -= 150;
                        BeamChat.currentUser.isVip = true;
                        renderVIP();
                        updateUI();
                    } else {
                        alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç');
                    }
                });
            }
        }

        // ==================== –ù–ê–°–¢–†–û–ô–ö–ò ====================
        function renderSettings() {
            if (!BeamChat.currentUser) {
                mainContent.innerHTML = `
                    <div class="content-header">
                        <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                    </div>
                    <div class="content-body">
                        <div class="empty-state">
                            <p style="margin-bottom:20px;">–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</p>
                            <button class="btn btn-primary" id="loginFromSettings">–í–æ–π—Ç–∏</button>
                        </div>
                    </div>
                `;
                document.getElementById('loginFromSettings').addEventListener('click', () => {
                    authModal.classList.remove('hidden');
                });
                return;
            }

            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                </div>
                <div class="content-body">
                    <div class="settings-section">
                        <h3 style="margin-bottom:25px; color:white;">–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        
                        <div class="settings-row">
                            <span>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
                            <input type="text" id="settingsUsername" class="modal-input" style="width:300px;" value="${BeamChat.currentUser.username || ''}">
                        </div>
                        
                        <div class="settings-row">
                            <span>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞</span>
                            <input type="email" id="settingsEmail" class="modal-input" style="width:300px;" value="${BeamChat.currentUser.email || ''}">
                        </div>
                        
                        <div class="settings-row">
                            <span>VIP —Å—Ç–∞—Ç—É—Å</span>
                            <span class="${BeamChat.currentUser.isVip ? 'stat-value' : ''}">${BeamChat.currentUser.isVip ? '‚úÖ VIP' : '‚ùå –ù–µ—Ç'}</span>
                        </div>
                        
                        <div class="settings-row">
                            <span>–ú–æ–Ω–µ—Ç—ã</span>
                            <span class="stat-value">üí∞ ${BeamChat.currentUser.coins || 0}</span>
                        </div>
                        
                        <div class="settings-row">
                            <span>–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</span>
                            <span class="stat-value">üë• ${BeamChat.currentUser.subscribers || 0}</span>
                        </div>
                        
                        <div style="margin-top:30px; display:flex; gap:15px;">
                            <button class="btn btn-primary" id="saveSettingsBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                            <button class="btn btn-secondary" id="logoutBtn">–í—ã–π—Ç–∏</button>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('saveSettingsBtn').addEventListener('click', () => {
                BeamChat.currentUser.username = document.getElementById('settingsUsername').value;
                BeamChat.currentUser.email = document.getElementById('settingsEmail').value;
                alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                updateUI();
            });

            document.getElementById('logoutBtn').addEventListener('click', () => {
                BeamChat.currentUser = null;
                BeamChat.state.activeChat = null;
                updateUI();
                showView('chats');
            });
        }

        // ==================== –†–ï–ê–ö–¶–ò–ò ====================
        window.addReaction = function(chatId, msgId, reaction) {
            const msg = BeamChat.db.messages[chatId]?.find(m => m.id === msgId);
            if (msg) {
                if (!msg.reactions) msg.reactions = [];
                if (msg.reactions.includes(reaction)) {
                    msg.reactions = msg.reactions.filter(r => r !== reaction);
                } else {
                    msg.reactions.push(reaction);
                }
                renderChatWindow(chatId);
            }
        };

        window.showReactionPicker = function(chatId, msgId) {
            const reactions = ['üëç', '‚ù§Ô∏è', 'üî•', 'üòÇ', 'üòÆ', 'üò¢', 'üëé'];
            const picker = document.createElement('div');
            picker.style.cssText = `
                position: fixed; top:50%; left:50%; transform:translate(-50%,-50%);
                background: #1a2440; padding:20px; border-radius:40px; border:2px solid #4f7ae0;
                display:flex; gap:10px; z-index:2000;
            `;
            picker.innerHTML = reactions.map(r => 
                `<span style="font-size:2rem; cursor:pointer;" onclick="addReaction(${chatId}, ${msgId}, '${r}'); this.parentElement.remove();">${r}</span>`
            ).join('');
            document.body.appendChild(picker);
            
            setTimeout(() => picker.remove(), 5000);
        };

        // ==================== –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ====================
        document.getElementById('registerBtn').addEventListener('click', () => {
            const username = document.getElementById('regUsername').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value;
            const confirm = document.getElementById('regConfirm').value;

            if (!username || !email || !password || !confirm) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            if (password !== confirm) {
                alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
                return;
            }

            if (password.length < 6) {
                alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤');
                return;
            }

            const newUser = {
                id: Date.now(),
                username: username,
                email: email,
                password: password,
                isVip: false,
                coins: 200,
                subscribers: 0
            };

            BeamChat.db.users.push(newUser);
            BeamChat.currentUser = newUser;
            
            authModal.classList.add('hidden');
            updateUI();
            showView('chats');
        });

        document.getElementById('switchToLoginBtn').addEventListener('click', () => {
            const title = document.getElementById('authTitle');
            if (title.textContent === '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è') {
                title.textContent = '–í—Ö–æ–¥';
                document.getElementById('registerBtn').textContent = '–í–æ–π—Ç–∏';
                document.getElementById('switchToLoginBtn').textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
            } else {
                title.textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
                document.getElementById('registerBtn').textContent = '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è';
                document.getElementById('switchToLoginBtn').textContent = '–í–æ–π—Ç–∏';
            }
        });

        document.getElementById('guestBtn').addEventListener('click', () => {
            BeamChat.currentUser = {
                id: 'guest_' + Date.now(),
                username: '–ì–æ—Å—Ç—å',
                email: 'guest@beam.chat',
                isVip: false,
                coins: 100,
                subscribers: 0
            };
            authModal.classList.add('hidden');
            updateUI();
            showView('chats');
        });

        // ==================== –ú–û–î–ê–õ–ö–ò ====================
        document.getElementById('closeCreateChat').addEventListener('click', () => {
            createChatModal.classList.add('hidden');
        });

        document.getElementById('createChatConfirm').addEventListener('click', () => {
            const name = document.getElementById('chatName').value.trim();
            const type = document.getElementById('chatType').value;
            
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞');
                return;
            }

            const newChat = {
                id: Date.now(),
                name: name,
                type: type,
                avatar: type === 'group' ? 'üë•' : name.charAt(0),
                lastMsg: '–ß–∞—Ç —Å–æ–∑–¥–∞–Ω',
                time: '—Ç–æ–ª—å–∫–æ —á—Ç–æ',
                unread: 0
            };

            BeamChat.db.chats.push(newChat);
            BeamChat.db.messages[newChat.id] = [];
            createChatModal.classList.add('hidden');
            document.getElementById('chatName').value = '';
            renderChats();
        });

        document.getElementById('closeCreateChannel').addEventListener('click', () => {
            createChannelModal.classList.add('hidden');
        });

        document.getElementById('createChannelConfirm').addEventListener('click', () => {
            const name = document.getElementById('channelName').value.trim();
            const desc = document.getElementById('channelDesc').value.trim();
            
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞');
                return;
            }

            const newChannel = {
                id: Date.now(),
                name: name,
                description: desc,
                avatar: 'üì¢',
                subscribers: 1,
                isSubscribed: true
            };

            BeamChat.db.channels.push(newChannel);
            
            BeamChat.db.chats.push({
                id: newChannel.id,
                name: name,
                type: 'channel',
                avatar: 'üì¢',
                lastMsg: '–ö–∞–Ω–∞–ª —Å–æ–∑–¥–∞–Ω',
                time: '—Ç–æ–ª—å–∫–æ —á—Ç–æ',
                unread: 0
            });
            
            BeamChat.db.messages[newChannel.id] = [];
            createChannelModal.classList.add('hidden');
            document.getElementById('channelName').value = '';
            document.getElementById('channelDesc').value = '';
            renderChannels();
        });

        document.getElementById('closeGiftModal').addEventListener('click', () => {
            giftModal.classList.add('hidden');
        });

        // ==================== –ù–ê–í–ò–ì–ê–¶–ò–Ø ====================
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => showView(item.dataset.view));
        });

        document.getElementById('profileBtn').addEventListener('click', () => {
            if (!BeamChat.currentUser) {
                authModal.classList.remove('hidden');
            } else {
                showView('settings');
            }
        });

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        setTimeout(() => {
            if (!BeamChat.currentUser) {
                authModal.classList.remove('hidden');
            }
        }, 500);

        updateUI();
        renderMainContent();
    </script>
</body>
</html><!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeamChat ¬∑ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600;14..32,700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }
        body {
            background: #0a0c14;
            color: white;
            overflow: hidden;
        }
        .app {
            display: flex;
            height: 100vh;
            width: 100vw;
        }
        /* –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é */
        .sidebar {
            width: 300px;
            background: #121b30;
            border-right: 1px solid #253153;
            display: flex;
            flex-direction: column;
        }
        .profile-header {
            padding: 20px;
            border-bottom: 1px solid #253153;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .avatar {
            width: 54px;
            height: 54px;
            background: linear-gradient(145deg, #2b4b9e, #1f3a7a);
            border-radius: 40%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 600;
        }
        .user-info h3 {
            font-size: 1.1rem;
            color: white;
        }
        .user-info p {
            font-size: 0.8rem;
            color: #8a9fd1;
        }
        .vip-badge {
            background: gold;
            color: #0a0c14;
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 700;
            display: inline-block;
            margin-top: 4px;
        }
        .nav-menu {
            flex: 1;
            padding: 20px 0;
        }
        .nav-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 14px 25px;
            color: #a7b9f0;
            cursor: pointer;
            transition: 0.2s;
        }
        .nav-item:hover, .nav-item.active {
            background: #1f2b4a;
            color: white;
            border-left: 3px solid #4f7ae0;
        }
        .badge {
            background: #bf4b4b;
            color: white;
            border-radius: 30px;
            padding: 2px 8px;
            font-size: 0.7rem;
            margin-left: auto;
        }
        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .content-header {
            padding: 20px 30px;
            background: #121b30;
            border-bottom: 1px solid #253153;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .content-header h2 {
            font-size: 1.8rem;
            color: white;
        }
        .content-body {
            flex: 1;
            overflow-y: auto;
            padding: 20px 30px;
        }
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            padding: 10px 20px;
            border-radius: 30px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
        }
        .btn-primary {
            background: #2b4b9e;
            color: white;
        }
        .btn-primary:hover {
            background: #3d62c0;
        }
        .btn-secondary {
            background: #2f3d66;
            color: white;
        }
        .btn-success {
            background: #2e7d32;
            color: white;
        }
        .btn-danger {
            background: #8b2e2e;
            color: white;
        }
        /* –°–ø–∏—Å–∫–∏ */
        .chats-list, .contacts-list, .channels-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .chat-item, .contact-item, .channel-item {
            background: #1a2440;
            border-radius: 28px;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            border: 1px solid #2f3d66;
            transition: 0.2s;
        }
        .chat-item:hover, .contact-item:hover, .channel-item:hover {
            background: #223052;
            border-color: #4f7ae0;
        }
        .chat-avatar, .contact-avatar, .channel-avatar {
            width: 56px;
            height: 56px;
            background: #2b3e7a;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
        }
        .chat-info, .contact-info, .channel-info {
            flex: 1;
        }
        .chat-name, .contact-name, .channel-name {
            font-weight: 600;
            font-size: 1.1rem;
            color: white;
        }
        .chat-last, .contact-status, .channel-subscribers {
            color: #8a9fd1;
            font-size: 0.9rem;
        }
        .unread {
            background: #4f7ae0;
            border-radius: 30px;
            padding: 4px 10px;
            font-size: 0.8rem;
            color: white;
        }
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-content {
            background: #1a2440;
            border-radius: 48px;
            padding: 40px;
            min-width: 450px;
            border: 2px solid #4f7ae0;
        }
        .modal-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
            color: white;
        }
        .modal-input {
            width: 100%;
            background: #1f294a;
            border: 1px solid #314a7a;
            border-radius: 40px;
            padding: 15px 20px;
            color: white;
            margin-bottom: 15px;
            outline: none;
        }
        .modal-input:focus {
            border-color: #5f8aff;
        }
        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        .hidden {
            display: none !important;
        }
        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .message {
            max-width: 70%;
            display: flex;
            flex-direction: column;
        }
        .message.outgoing {
            align-self: flex-end;
        }
        .message-bubble {
            padding: 12px 18px;
            border-radius: 24px;
            background: #262f50;
            color: white;
        }
        .message.outgoing .message-bubble {
            background: #2b4b9e;
        }
        .message-footer {
            display: flex;
            gap: 10px;
            margin-top: 4px;
            font-size: 0.8rem;
            color: #8a9fd1;
        }
        .reaction {
            cursor: pointer;
            padding: 2px 6px;
            background: #1f294a;
            border-radius: 20px;
            color: white;
        }
        .message-input-area {
            display: flex;
            gap: 10px;
            padding: 20px;
            background: #121b30;
        }
        .message-input {
            flex: 1;
            background: #1f294a;
            border: 1px solid #314a7a;
            border-radius: 40px;
            padding: 15px 20px;
            color: white;
            outline: none;
        }
        /* –ü–æ–¥–∞—Ä–∫–∏ */
        .gifts-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .gift-card {
            background: #1f2a48;
            border-radius: 24px;
            padding: 20px;
            text-align: center;
            border: 1px solid #3e5a9c;
            color: white;
        }
        .gift-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-section {
            background: #1a2440;
            border-radius: 32px;
            padding: 30px;
            margin-bottom: 20px;
        }
        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #2a3a60;
            color: white;
        }
        .settings-row:last-child {
            border-bottom: none;
        }
        .twofa-enabled {
            color: #4cd964;
            font-weight: 600;
        }
        .stat-value {
            color: #ffd966;
            font-weight: 600;
        }
        /* –ü–æ–∏—Å–∫ */
        .search-input {
            width: 100%;
            background: #1f294a;
            border: 1px solid #314a7a;
            border-radius: 40px;
            padding: 12px 20px;
            color: white;
            margin-bottom: 20px;
            outline: none;
        }
        .empty-state {
            text-align: center;
            color: #8a9fd1;
            padding: 60px 20px;
            background: #1a2440;
            border-radius: 32px;
        }
    </style>
</head>
<body>
    <div class="app" id="app">
        <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
        <div class="sidebar" id="sidebar">
            <div class="profile-header" id="profileBtn">
                <div class="avatar" id="avatar">‚ö°</div>
                <div class="user-info">
                    <h3 id="displayName">–ì–æ—Å—Ç—å</h3>
                    <p id="displayEmail">–Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω</p>
                    <span class="vip-badge hidden" id="vipBadge">VIP</span>
                </div>
            </div>
            <div class="nav-menu">
                <div class="nav-item active" data-view="chats">
                    <span>üí¨</span> –ß–∞—Ç—ã
                    <span class="badge" id="chatsBadge">0</span>
                </div>
                <div class="nav-item" data-view="contacts">
                    <span>üë•</span> –ö–æ–Ω—Ç–∞–∫—Ç—ã
                </div>
                <div class="nav-item" data-view="channels">
                    <span>üì¢</span> –ö–∞–Ω–∞–ª—ã
                </div>
                <div class="nav-item" data-view="gifts">
                    <span>üéÅ</span> –ü–æ–¥–∞—Ä–∫–∏
                </div>
                <div class="nav-item" data-view="vip">
                    <span>üëë</span> VIP –ø–æ–¥–ø–∏—Å–∫–∞
                </div>
                <div class="nav-item" data-view="settings">
                    <span>‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content" id="mainContent">
            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–≤—Ö–æ–¥–∞ -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-title" id="authTitle">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
            <input type="text" class="modal-input" id="regUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            <input type="email" class="modal-input" id="regEmail" placeholder="–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞">
            <input type="password" class="modal-input" id="regPassword" placeholder="–ü–∞—Ä–æ–ª—å">
            <input type="password" class="modal-input" id="regConfirm" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è">
            <div class="modal-buttons">
                <button class="btn btn-primary" id="registerBtn" style="flex:1;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <button class="btn btn-secondary" id="switchToLoginBtn">–í–æ–π—Ç–∏</button>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-secondary" id="guestBtn">–í–æ–π—Ç–∏ –∫–∞–∫ –≥–æ—Å—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞ -->
    <div class="modal hidden" id="createChatModal">
        <div class="modal-content">
            <div class="modal-title">–°–æ–∑–¥–∞—Ç—å —á–∞—Ç</div>
            <select class="modal-input" id="chatType">
                <option value="private">–õ–∏—á–Ω—ã–π —á–∞—Ç</option>
                <option value="group">–ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç</option>
            </select>
            <input type="text" class="modal-input" id="chatName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞">
            <div class="modal-buttons">
                <button class="btn btn-primary" id="createChatConfirm">–°–æ–∑–¥–∞—Ç—å</button>
                <button class="btn btn-secondary" id="closeCreateChat">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–Ω–∞–ª–∞ -->
    <div class="modal hidden" id="createChannelModal">
        <div class="modal-content">
            <div class="modal-title">–°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª</div>
            <input type="text" class="modal-input" id="channelName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞">
            <textarea class="modal-input" id="channelDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞" rows="3"></textarea>
            <div class="modal-buttons">
                <button class="btn btn-primary" id="createChannelConfirm">–°–æ–∑–¥–∞—Ç—å</button>
                <button class="btn btn-secondary" id="closeCreateChannel">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥–∞—Ä–∫–æ–≤ -->
    <div class="modal hidden" id="giftModal">
        <div class="modal-content">
            <div class="modal-title">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–∞—Ä–æ–∫</div>
            <div class="gifts-grid" id="giftsGrid"></div>
            <button class="btn btn-secondary" id="closeGiftModal">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        // ==================== –î–ê–ù–ù–´–ï ====================
        const BeamChat = {
            currentUser: null,
            state: {
                currentView: 'chats',
                activeChat: null,
                activeChannel: null
            },
            db: {
                users: [],
                chats: [],
                channels: [],
                contacts: [],
                messages: {},
                gifts: [
                    { id: 1, name: 'üíé –ê–ª–º–∞–∑', price: 50, icon: 'üíé' },
                    { id: 2, name: 'üåπ –†–æ–∑–∞', price: 10, icon: 'üåπ' },
                    { id: 3, name: 'üöÄ –†–∞–∫–µ—Ç–∞', price: 100, icon: 'üöÄ' },
                    { id: 4, name: 'üëë –ö–æ—Ä–æ–Ω–∞ VIP', price: 200, icon: 'üëë', vipOnly: true },
                    { id: 5, name: 'üéÇ –¢–æ—Ä—Ç', price: 75, icon: 'üéÇ' },
                    { id: 6, name: 'üêª –ú–∏—à–∫–∞', price: 30, icon: 'üêª' }
                ]
            }
        };

        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        BeamChat.db.chats = [
            { id: 1, name: '–ê–Ω–Ω–∞ –°–≤–µ—Ç–ª–æ–≤–∞', type: 'private', avatar: '–ê', lastMsg: '–ü—Ä–∏–≤–µ—Ç!', time: '10:30', unread: 2 },
            { id: 2, name: '–ö–æ–º–∞–Ω–¥–∞ Beam', type: 'group', avatar: 'üë•', lastMsg: '–í—Å—Ç—Ä–µ—á–∞ –≤ 15:00', time: '–í—á–µ—Ä–∞', unread: 0 },
            { id: 3, name: '–ù–æ–≤–æ—Å—Ç–∏ Beam', type: 'channel', avatar: 'üì¢', lastMsg: '–†–µ–ª–∏–∑ 2.0', time: '12:45', unread: 5 }
        ];

        BeamChat.db.channels = [
            { id: 101, name: 'Beam Official', avatar: 'üì°', subscribers: 1250, isSubscribed: true },
            { id: 102, name: '–ò–≥—Ä–æ–≤–æ–π –º–∏—Ä', avatar: 'üéÆ', subscribers: 540, isSubscribed: false }
        ];

        BeamChat.db.contacts = [
            { id: 1, name: '–ê–Ω–Ω–∞ –°–≤–µ—Ç–ª–æ–≤–∞', status: 'online', avatar: '–ê', subscribers: 120 },
            { id: 2, name: '–î–º–∏—Ç—Ä–∏–π –í–æ–ª–∫–æ–≤', status: 'offline', avatar: '–î', subscribers: 45 },
            { id: 3, name: '–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞ –õ—É—á', status: 'online', avatar: '–ï', subscribers: 230 }
        ];

        BeamChat.db.messages = {
            1: [
                { id: 1, text: '–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?', time: '10:30', outgoing: false, reactions: [] },
                { id: 2, text: '–û—Ç–ª–∏—á–Ω–æ! –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ', time: '10:32', outgoing: true, reactions: [] }
            ],
            2: [
                { id: 1, text: '–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç –≤ –≥—Ä—É–ø–ø–µ', time: '09:15', outgoing: false, reactions: ['üëç'] }
            ],
            3: [
                { id: 1, text: '–í—ã—à–µ–ª –Ω–æ–≤—ã–π —Ä–µ–ª–∏–∑', time: '12:45', outgoing: false, reactions: ['üî•', 'üëç'] }
            ]
        };

        // ==================== UI –≠–õ–ï–ú–ï–ù–¢–´ ====================
        const mainContent = document.getElementById('mainContent');
        const authModal = document.getElementById('authModal');
        const createChatModal = document.getElementById('createChatModal');
        const createChannelModal = document.getElementById('createChannelModal');
        const giftModal = document.getElementById('giftModal');
        const displayName = document.getElementById('displayName');
        const displayEmail = document.getElementById('displayEmail');
        const avatar = document.getElementById('avatar');
        const vipBadge = document.getElementById('vipBadge');
        const chatsBadge = document.getElementById('chatsBadge');

        // ==================== –§–£–ù–ö–¶–ò–ò ====================
        function updateUI() {
            if (BeamChat.currentUser) {
                displayName.textContent = BeamChat.currentUser.username;
                displayEmail.textContent = BeamChat.currentUser.email || '–Ω–µ—Ç –ø–æ—á—Ç—ã';
                avatar.textContent = BeamChat.currentUser.username.charAt(0).toUpperCase();
                if (BeamChat.currentUser.isVip) {
                    vipBadge.classList.remove('hidden');
                } else {
                    vipBadge.classList.add('hidden');
                }
            } else {
                displayName.textContent = '–ì–æ—Å—Ç—å';
                displayEmail.textContent = '–Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω';
                avatar.textContent = '‚ö°';
                vipBadge.classList.add('hidden');
            }
            
            const unreadCount = BeamChat.db.chats.reduce((sum, chat) => sum + (chat.unread || 0), 0);
            chatsBadge.textContent = unreadCount || '0';
        }

        function showView(view) {
            BeamChat.state.currentView = view;
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.view === view) item.classList.add('active');
            });
            renderMainContent();
        }

        function renderMainContent() {
            const view = BeamChat.state.currentView;
            mainContent.innerHTML = '';

            switch(view) {
                case 'chats': renderChats(); break;
                case 'contacts': renderContacts(); break;
                case 'channels': renderChannels(); break;
                case 'gifts': renderGifts(); break;
                case 'vip': renderVIP(); break;
                case 'settings': renderSettings(); break;
                default: renderChats();
            }
        }

        // ==================== –ß–ê–¢–´ ====================
        function renderChats() {
            if (BeamChat.state.activeChat) {
                renderChatWindow(BeamChat.state.activeChat);
                return;
            }

            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>–ß–∞—Ç—ã</h2>
                    <button class="btn btn-primary" id="createChatBtn">‚ûï –°–æ–∑–¥–∞—Ç—å —á–∞—Ç</button>
                    <button class="btn btn-primary" id="createChannelBtn">üì¢ –°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª</button>
                </div>
                <div class="content-body">
                    <input type="text" class="search-input" id="searchChats" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ —á–∞—Ç–∞–º...">
                    <div class="chats-list" id="chatsList"></div>
                </div>
            `;

            const chatsList = document.getElementById('chatsList');
            renderChatsList(chatsList, BeamChat.db.chats);

            document.getElementById('createChatBtn').addEventListener('click', () => {
                createChatModal.classList.remove('hidden');
            });

            document.getElementById('createChannelBtn').addEventListener('click', () => {
                createChannelModal.classList.remove('hidden');
            });

            document.getElementById('searchChats').addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                const filtered = BeamChat.db.chats.filter(chat => 
                    chat.name.toLowerCase().includes(query)
                );
                renderChatsList(chatsList, filtered);
            });
        }

        function renderChatsList(container, chats) {
            container.innerHTML = '';
            
            if (chats.length === 0) {
                container.innerHTML = '<div class="empty-state">–ß–∞—Ç–æ–≤ –Ω–µ—Ç. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π!</div>';
                return;
            }

            chats.forEach(chat => {
                const item = document.createElement('div');
                item.className = 'chat-item';
                item.innerHTML = `
                    <div class="chat-avatar">${chat.avatar}</div>
                    <div class="chat-info">
                        <div class="chat-name">${chat.name}</div>
                        <div class="chat-last">${chat.lastMsg || '–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π'} ¬∑ ${chat.time || ''}</div>
                    </div>
                    ${chat.unread > 0 ? `<span class="unread">${chat.unread}</span>` : ''}
                `;
                item.addEventListener('click', () => {
                    BeamChat.state.activeChat = chat.id;
                    renderChats();
                });
                container.appendChild(item);
            });
        }

        function renderChatWindow(chatId) {
            const chat = BeamChat.db.chats.find(c => c.id === chatId);
            if (!chat) return;

            mainContent.innerHTML = `
                <div class="content-header">
                    <button class="btn btn-secondary" id="backBtn">‚Üê –ù–∞–∑–∞–¥</button>
                    <h2>${chat.name}</h2>
                    <button class="btn btn-primary" id="chatSettingsBtn">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </div>
                <div class="messages-container" id="messages"></div>
                <div class="message-input-area">
                    <input type="text" class="message-input" id="messageInput" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ...">
                    <button class="btn btn-primary" id="sendBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            `;

            const messages = BeamChat.db.messages[chatId] || [];
            const messagesDiv = document.getElementById('messages');
            
            if (messages.length === 0) {
                messagesDiv.innerHTML = '<div class="empty-state">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π. –ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å!</div>';
            } else {
                messages.forEach(msg => {
                    const msgDiv = document.createElement('div');
                    msgDiv.className = `message ${msg.outgoing ? 'outgoing' : 'incoming'}`;
                    msgDiv.innerHTML = `
                        <div class="message-bubble">${msg.text}</div>
                        <div class="message-footer">
                            <span>${msg.time}</span>
                            <div>
                                ${(msg.reactions || []).map(r => `<span class="reaction" onclick="addReaction(${chatId}, ${msg.id}, '${r}')">${r}</span>`).join('')}
                                <span class="reaction" onclick="showReactionPicker(${chatId}, ${msg.id})">‚ûï</span>
                            </div>
                        </div>
                    `;
                    messagesDiv.appendChild(msgDiv);
                });
            }

            document.getElementById('sendBtn').addEventListener('click', () => {
                const input = document.getElementById('messageInput');
                if (!input.value.trim()) return;
                
                const newMsg = {
                    id: Date.now(),
                    text: input.value,
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    outgoing: true,
                    reactions: []
                };
                
                if (!BeamChat.db.messages[chatId]) BeamChat.db.messages[chatId] = [];
                BeamChat.db.messages[chatId].push(newMsg);
                chat.lastMsg = input.value;
                chat.time = '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
                
                renderChatWindow(chatId);
            });

            document.getElementById('backBtn').addEventListener('click', () => {
                BeamChat.state.activeChat = null;
                renderChats();
            });

            document.getElementById('chatSettingsBtn').addEventListener('click', () => {
                showChatSettings(chat);
            });
        }

        function showChatSettings(chat) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞</div>
                    <p style="color:white; margin-bottom:10px;">–ù–∞–∑–≤–∞–Ω–∏–µ: ${chat.name}</p>
                    <p style="color:white; margin-bottom:10px;">–¢–∏–ø: ${chat.type === 'private' ? '–õ–∏—á–Ω—ã–π' : '–ì—Ä—É–ø–ø–æ–≤–æ–π'}</p>
                    <input type="text" id="newChatName" class="modal-input" placeholder="–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" value="${chat.name}">
                    <div class="modal-buttons">
                        <button class="btn btn-primary" id="renameChatBtn">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-danger" id="deleteChatBtn">–£–¥–∞–ª–∏—Ç—å —á–∞—Ç</button>
                        <button class="btn btn-secondary" id="closeModal">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            document.getElementById('renameChatBtn').addEventListener('click', () => {
                const newName = document.getElementById('newChatName').value.trim();
                if (newName) {
                    chat.name = newName;
                    modal.remove();
                    renderChatWindow(chat.id);
                }
            });

            document.getElementById('deleteChatBtn').addEventListener('click', () => {
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —á–∞—Ç?')) {
                    const index = BeamChat.db.chats.findIndex(c => c.id === chat.id);
                    if (index !== -1) BeamChat.db.chats.splice(index, 1);
                    delete BeamChat.db.messages[chat.id];
                    modal.remove();
                    BeamChat.state.activeChat = null;
                    renderChats();
                }
            });

            document.getElementById('closeModal').addEventListener('click', () => modal.remove());
        }

        // ==================== –ö–û–ù–¢–ê–ö–¢–´ ====================
        function renderContacts() {
            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
                    <button class="btn btn-primary" id="addContactBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div class="content-body">
                    <input type="text" class="search-input" id="searchContacts" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤...">
                    <div class="contacts-list" id="contactsList"></div>
                </div>
            `;

            const contactsList = document.getElementById('contactsList');
            renderContactsList(contactsList, BeamChat.db.contacts);

            document.getElementById('addContactBtn').addEventListener('click', () => {
                const name = prompt('–ò–º—è –∫–æ–Ω—Ç–∞–∫—Ç–∞:');
                if (name) {
                    BeamChat.db.contacts.push({
                        id: Date.now(),
                        name: name,
                        status: 'offline',
                        avatar: name.charAt(0),
                        subscribers: 0
                    });
                    renderContacts();
                }
            });

            document.getElementById('searchContacts').addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                const filtered = BeamChat.db.contacts.filter(c => 
                    c.name.toLowerCase().includes(query)
                );
                renderContactsList(contactsList, filtered);
            });
        }

        function renderContactsList(container, contacts) {
            container.innerHTML = '';
            
            contacts.forEach(contact => {
                const item = document.createElement('div');
                item.className = 'contact-item';
                item.innerHTML = `
                    <div class="contact-avatar">${contact.avatar}</div>
                    <div class="contact-info">
                        <div class="contact-name">${contact.name}</div>
                        <div class="contact-status">
                            ${contact.status === 'online' ? '‚óè –í —Å–µ—Ç–∏' : '‚óã –ù–µ –≤ —Å–µ—Ç–∏'}
                            ¬∑ –ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: ${contact.subscribers || 0}
                        </div>
                    </div>
                    <div style="display:flex; gap:5px;">
                        <button class="btn btn-primary" data-id="${contact.id}" data-action="chat">üí¨</button>
                        <button class="btn btn-secondary" data-id="${contact.id}" data-action="subscribe">üîî</button>
                        <button class="btn btn-secondary" data-id="${contact.id}" data-action="gift">üéÅ</button>
                    </div>
                `;
                
                item.querySelector('[data-action="chat"]').addEventListener('click', (e) => {
                    e.stopPropagation();
                    const newChat = {
                        id: Date.now(),
                        name: contact.name,
                        type: 'private',
                        avatar: contact.avatar,
                        lastMsg: '–ù–æ–≤—ã–π —á–∞—Ç',
                        time: '—Ç–æ–ª—å–∫–æ —á—Ç–æ',
                        unread: 0
                    };
                    BeamChat.db.chats.push(newChat);
                    BeamChat.db.messages[newChat.id] = [];
                    showView('chats');
                });
                
                item.querySelector('[data-action="subscribe"]').addEventListener('click', (e) => {
                    e.stopPropagation();
                    contact.subscribers = (contact.subscribers || 0) + 1;
                    if (BeamChat.currentUser) {
                        BeamChat.currentUser.subscribers = (BeamChat.currentUser.subscribers || 0) + 1;
                    }
                    renderContacts();
                });
                
                item.querySelector('[data-action="gift"]').addEventListener('click', (e) => {
                    e.stopPropagation();
                    openGiftModal(contact);
                });
                
                container.appendChild(item);
            });
        }

        // ==================== –ö–ê–ù–ê–õ–´ ====================
        function renderChannels() {
            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>–ö–∞–Ω–∞–ª—ã</h2>
                    <button class="btn btn-primary" id="createChannelBtn">üì¢ –°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª</button>
                </div>
                <div class="content-body">
                    <div class="channels-list" id="channelsList"></div>
                </div>
            `;

            const channelsList = document.getElementById('channelsList');
            BeamChat.db.channels.forEach(channel => {
                const item = document.createElement('div');
                item.className = 'channel-item';
                item.innerHTML = `
                    <div class="channel-avatar">${channel.avatar}</div>
                    <div class="channel-info">
                        <div class="channel-name">${channel.name}</div>
                        <div class="channel-subscribers">üë• ${channel.subscribers} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div>
                    </div>
                    <button class="btn btn-${channel.isSubscribed ? 'secondary' : 'primary'}" data-id="${channel.id}">
                        ${channel.isSubscribed ? '‚úÖ –ü–æ–¥–ø–∏—Å–∞–Ω' : 'üîî –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è'}
                    </button>
                    <button class="btn btn-secondary" data-id="${channel.id}" data-action="settings">‚öôÔ∏è</button>
                `;
                
                item.querySelector('button:first-of-type').addEventListener('click', (e) => {
                    e.stopPropagation();
                    channel.isSubscribed = !channel.isSubscribed;
                    if (channel.isSubscribed) {
                        channel.subscribers++;
                    } else {
                        channel.subscribers--;
                    }
                    renderChannels();
                });
                
                item.querySelector('[data-action="settings"]').addEventListener('click', (e) => {
                    e.stopPropagation();
                    showChannelSettings(channel);
                });
                
                item.addEventListener('click', () => {
                    const channelChat = BeamChat.db.chats.find(c => c.id === channel.id);
                    if (channelChat) {
                        BeamChat.state.activeChat = channelChat.id;
                        renderChats();
                    }
                });
                
                channelsList.appendChild(item);
            });

            document.getElementById('createChannelBtn').addEventListener('click', () => {
                createChannelModal.classList.remove('hidden');
            });
        }

        function showChannelSettings(channel) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–Ω–∞–ª–∞</div>
                    <p style="color:white; margin-bottom:10px;">–ù–∞–∑–≤–∞–Ω–∏–µ: ${channel.name}</p>
                    <p style="color:white; margin-bottom:10px;">–ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: ${channel.subscribers}</p>
                    <input type="text" id="newChannelName" class="modal-input" placeholder="–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" value="${channel.name}">
                    <div class="modal-buttons">
                        <button class="btn btn-primary" id="renameChannelBtn">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-danger" id="deleteChannelBtn">–£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª</button>
                        <button class="btn btn-secondary" id="closeModal">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            document.getElementById('renameChannelBtn').addEventListener('click', () => {
                const newName = document.getElementById('newChannelName').value.trim();
                if (newName) {
                    channel.name = newName;
                    const channelChat = BeamChat.db.chats.find(c => c.id === channel.id);
                    if (channelChat) channelChat.name = newName;
                    modal.remove();
                    renderChannels();
                }
            });

            document.getElementById('deleteChannelBtn').addEventListener('click', () => {
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–∞–Ω–∞–ª?')) {
                    const index = BeamChat.db.channels.findIndex(c => c.id === channel.id);
                    if (index !== -1) BeamChat.db.channels.splice(index, 1);
                    
                    const chatIndex = BeamChat.db.chats.findIndex(c => c.id === channel.id);
                    if (chatIndex !== -1) BeamChat.db.chats.splice(chatIndex, 1);
                    
                    delete BeamChat.db.messages[channel.id];
                    modal.remove();
                    renderChannels();
                }
            });

            document.getElementById('closeModal').addEventListener('click', () => modal.remove());
        }

        // ==================== –ü–û–î–ê–†–ö–ò ====================
        function renderGifts() {
            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>üéÅ –ú–∞–≥–∞–∑–∏–Ω –ø–æ–¥–∞—Ä–∫–æ–≤</h2>
                    <div style="background:#1f294a; padding:10px 20px; border-radius:40px;">
                        üí∞ ${BeamChat.currentUser?.coins || 0} –º–æ–Ω–µ—Ç
                    </div>
                </div>
                <div class="content-body">
                    <div class="gifts-grid">
                        ${BeamChat.db.gifts.map(gift => `
                            <div class="gift-card">
                                <div class="gift-icon">${gift.icon}</div>
                                <div style="font-weight:600;">${gift.name}</div>
                                <div style="color:#ffd966; margin:10px 0;">${gift.price}üí∞</div>
                                ${gift.vipOnly ? '<div style="color:gold;">üëë VIP</div>' : ''}
                                <button class="btn btn-primary" data-gift='${JSON.stringify(gift)}' style="margin-top:10px;">–ö—É–ø–∏—Ç—å</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            document.querySelectorAll('[data-gift]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const gift = JSON.parse(e.target.dataset.gift);
                    buyGift(gift);
                });
            });
        }

        function buyGift(gift) {
            if (!BeamChat.currentUser) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É');
                authModal.classList.remove('hidden');
                return;
            }
            
            if (gift.vipOnly && !BeamChat.currentUser.isVip) {
                alert('–≠—Ç–æ—Ç –ø–æ–¥–∞—Ä–æ–∫ —Ç–æ–ª—å–∫–æ –¥–ª—è VIP');
                return;
            }
            
            if (BeamChat.currentUser.coins < gift.price) {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç');
                return;
            }
            
            BeamChat.currentUser.coins -= gift.price;
            alert(`–ü–æ–¥–∞—Ä–æ–∫ ${gift.name} –∫—É–ø–ª–µ–Ω!`);
            renderGifts();
        }

        function openGiftModal(contact) {
            const grid = document.getElementById('giftsGrid');
            grid.innerHTML = BeamChat.db.gifts.map(gift => `
                <div class="gift-card">
                    <div class="gift-icon">${gift.icon}</div>
                    <div>${gift.name}</div>
                    <div>${gift.price}üí∞</div>
                    <button class="btn btn-primary" onclick="sendGift(${contact.id}, ${gift.id})">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            `).join('');
            
            giftModal.classList.remove('hidden');
        }

        window.sendGift = function(contactId, giftId) {
            const contact = BeamChat.db.contacts.find(c => c.id === contactId);
            const gift = BeamChat.db.gifts.find(g => g.id === giftId);
            
            if (!BeamChat.currentUser) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É');
                return;
            }
            
            if (BeamChat.currentUser.coins >= gift.price) {
                BeamChat.currentUser.coins -= gift.price;
                alert(`–ü–æ–¥–∞—Ä–æ–∫ ${gift.name} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω ${contact.name}!`);
                giftModal.classList.add('hidden');
            } else {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç');
            }
        };

        // ==================== VIP ====================
        function renderVIP() {
            const isVip = BeamChat.currentUser?.isVip || false;
            
            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>üëë VIP –ü–æ–¥–ø–∏—Å–∫–∞</h2>
                </div>
                <div class="content-body">
                    ${isVip ? `
                        <div style="background: linear-gradient(145deg, #2a3f7a, #1c2b5a); border-radius: 32px; padding: 40px; text-align: center; margin-bottom: 30px; border: 2px solid gold;">
                            <div style="font-size: 5rem;">üëë</div>
                            <h3 style="font-size: 2rem; margin:20px 0; color:white;">–í—ã VIP!</h3>
                            <p style="color:#ffd966;">–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É</p>
                        </div>
                    ` : `
                        <div style="background: #1a2440; border-radius: 32px; padding: 40px; text-align: center; margin-bottom: 30px;">
                            <div style="font-size: 5rem;">‚ú®</div>
                            <h3 style="margin:20px 0; color:white;">–°—Ç–∞–Ω—å—Ç–µ VIP</h3>
                            <p style="color:#8a9fd1; margin-bottom:30px;">–ü–æ–ª—É—á–∏—Ç–µ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</p>
                            <button class="btn btn-primary" id="buyVipBtn" style="font-size:1.2rem; padding:15px 40px;">–ö—É–ø–∏—Ç—å VIP –∑–∞ 150üí∞</button>
                        </div>
                    `}
                    
                    <div style="background: #1a2440; border-radius: 24px; padding: 25px;">
                        <h3 style="margin-bottom:20px; color:white;">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ VIP</h3>
                        <ul style="list-style: none; color:#b5d0ff;">
                            <li style="margin:10px 0;">‚úì –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏</li>
                            <li style="margin:10px 0;">‚úì –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∑–Ω–∞—á–æ–∫ –≤ –ø—Ä–æ—Ñ–∏–ª–µ</li>
                            <li style="margin:10px 0;">‚úì 100 –º–æ–Ω–µ—Ç –µ–∂–µ–º–µ—Å—è—á–Ω–æ</li>
                            <li style="margin:10px 0;">‚úì –†–∞–Ω–Ω–∏–π –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º</li>
                        </ul>
                    </div>
                </div>
            `;

            const buyBtn = document.getElementById('buyVipBtn');
            if (buyBtn) {
                buyBtn.addEventListener('click', () => {
                    if (!BeamChat.currentUser) {
                        alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É');
                        authModal.classList.remove('hidden');
                        return;
                    }
                    
                    if (BeamChat.currentUser.coins >= 150) {
                        BeamChat.currentUser.coins -= 150;
                        BeamChat.currentUser.isVip = true;
                        renderVIP();
                        updateUI();
                    } else {
                        alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç');
                    }
                });
            }
        }

        // ==================== –ù–ê–°–¢–†–û–ô–ö–ò ====================
        function renderSettings() {
            if (!BeamChat.currentUser) {
                mainContent.innerHTML = `
                    <div class="content-header">
                        <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                    </div>
                    <div class="content-body">
                        <div class="empty-state">
                            <p style="margin-bottom:20px;">–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</p>
                            <button class="btn btn-primary" id="loginFromSettings">–í–æ–π—Ç–∏</button>
                        </div>
                    </div>
                `;
                document.getElementById('loginFromSettings').addEventListener('click', () => {
                    authModal.classList.remove('hidden');
                });
                return;
            }

            mainContent.innerHTML = `
                <div class="content-header">
                    <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                </div>
                <div class="content-body">
                    <div class="settings-section">
                        <h3 style="margin-bottom:25px; color:white;">–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        
                        <div class="settings-row">
                            <span>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
                            <input type="text" id="settingsUsername" class="modal-input" style="width:300px;" value="${BeamChat.currentUser.username || ''}">
                        </div>
                        
                        <div class="settings-row">
                            <span>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞</span>
                            <input type="email" id="settingsEmail" class="modal-input" style="width:300px;" value="${BeamChat.currentUser.email || ''}">
                        </div>
                        
                        <div class="settings-row">
                            <span>VIP —Å—Ç–∞—Ç—É—Å</span>
                            <span class="${BeamChat.currentUser.isVip ? 'stat-value' : ''}">${BeamChat.currentUser.isVip ? '‚úÖ VIP' : '‚ùå –ù–µ—Ç'}</span>
                        </div>
                        
                        <div class="settings-row">
                            <span>–ú–æ–Ω–µ—Ç—ã</span>
                            <span class="stat-value">üí∞ ${BeamChat.currentUser.coins || 0}</span>
                        </div>
                        
                        <div class="settings-row">
                            <span>–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</span>
                            <span class="stat-value">üë• ${BeamChat.currentUser.subscribers || 0}</span>
                        </div>
                        
                        <div style="margin-top:30px; display:flex; gap:15px;">
                            <button class="btn btn-primary" id="saveSettingsBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                            <button class="btn btn-secondary" id="logoutBtn">–í—ã–π—Ç–∏</button>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('saveSettingsBtn').addEventListener('click', () => {
                BeamChat.currentUser.username = document.getElementById('settingsUsername').value;
                BeamChat.currentUser.email = document.getElementById('settingsEmail').value;
                alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                updateUI();
            });

            document.getElementById('logoutBtn').addEventListener('click', () => {
                BeamChat.currentUser = null;
                BeamChat.state.activeChat = null;
                updateUI();
                showView('chats');
            });
        }

        // ==================== –†–ï–ê–ö–¶–ò–ò ====================
        window.addReaction = function(chatId, msgId, reaction) {
            const msg = BeamChat.db.messages[chatId]?.find(m => m.id === msgId);
            if (msg) {
                if (!msg.reactions) msg.reactions = [];
                if (msg.reactions.includes(reaction)) {
                    msg.reactions = msg.reactions.filter(r => r !== reaction);
                } else {
                    msg.reactions.push(reaction);
                }
                renderChatWindow(chatId);
            }
        };

        window.showReactionPicker = function(chatId, msgId) {
            const reactions = ['üëç', '‚ù§Ô∏è', 'üî•', 'üòÇ', 'üòÆ', 'üò¢', 'üëé'];
            const picker = document.createElement('div');
            picker.style.cssText = `
                position: fixed; top:50%; left:50%; transform:translate(-50%,-50%);
                background: #1a2440; padding:20px; border-radius:40px; border:2px solid #4f7ae0;
                display:flex; gap:10px; z-index:2000;
            `;
            picker.innerHTML = reactions.map(r => 
                `<span style="font-size:2rem; cursor:pointer;" onclick="addReaction(${chatId}, ${msgId}, '${r}'); this.parentElement.remove();">${r}</span>`
            ).join('');
            document.body.appendChild(picker);
            
            setTimeout(() => picker.remove(), 5000);
        };

        // ==================== –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ====================
        document.getElementById('registerBtn').addEventListener('click', () => {
            const username = document.getElementById('regUsername').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value;
            const confirm = document.getElementById('regConfirm').value;

            if (!username || !email || !password || !confirm) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            if (password !== confirm) {
                alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
                return;
            }

            if (password.length < 6) {
                alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤');
                return;
            }

            const newUser = {
                id: Date.now(),
                username: username,
                email: email,
                password: password,
                isVip: false,
                coins: 200,
                subscribers: 0
            };

            BeamChat.db.users.push(newUser);
            BeamChat.currentUser = newUser;
            
            authModal.classList.add('hidden');
            updateUI();
            showView('chats');
        });

        document.getElementById('switchToLoginBtn').addEventListener('click', () => {
            const title = document.getElementById('authTitle');
            if (title.textContent === '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è') {
                title.textContent = '–í—Ö–æ–¥';
                document.getElementById('registerBtn').textContent = '–í–æ–π—Ç–∏';
                document.getElementById('switchToLoginBtn').textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
            } else {
                title.textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
                document.getElementById('registerBtn').textContent = '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è';
                document.getElementById('switchToLoginBtn').textContent = '–í–æ–π—Ç–∏';
            }
        });

        document.getElementById('guestBtn').addEventListener('click', () => {
            BeamChat.currentUser = {
                id: 'guest_' + Date.now(),
                username: '–ì–æ—Å—Ç—å',
                email: 'guest@beam.chat',
                isVip: false,
                coins: 100,
                subscribers: 0
            };
            authModal.classList.add('hidden');
            updateUI();
            showView('chats');
        });

        // ==================== –ú–û–î–ê–õ–ö–ò ====================
        document.getElementById('closeCreateChat').addEventListener('click', () => {
            createChatModal.classList.add('hidden');
        });

        document.getElementById('createChatConfirm').addEventListener('click', () => {
            const name = document.getElementById('chatName').value.trim();
            const type = document.getElementById('chatType').value;
            
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞');
                return;
            }

            const newChat = {
                id: Date.now(),
                name: name,
                type: type,
                avatar: type === 'group' ? 'üë•' : name.charAt(0),
                lastMsg: '–ß–∞—Ç —Å–æ–∑–¥–∞–Ω',
                time: '—Ç–æ–ª—å–∫–æ —á—Ç–æ',
                unread: 0
            };

            BeamChat.db.chats.push(newChat);
            BeamChat.db.messages[newChat.id] = [];
            createChatModal.classList.add('hidden');
            document.getElementById('chatName').value = '';
            renderChats();
        });

        document.getElementById('closeCreateChannel').addEventListener('click', () => {
            createChannelModal.classList.add('hidden');
        });

        document.getElementById('createChannelConfirm').addEventListener('click', () => {
            const name = document.getElementById('channelName').value.trim();
            const desc = document.getElementById('channelDesc').value.trim();
            
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞');
                return;
            }

            const newChannel = {
                id: Date.now(),
                name: name,
                description: desc,
                avatar: 'üì¢',
                subscribers: 1,
                isSubscribed: true
            };

            BeamChat.db.channels.push(newChannel);
            
            BeamChat.db.chats.push({
                id: newChannel.id,
                name: name,
                type: 'channel',
                avatar: 'üì¢',
                lastMsg: '–ö–∞–Ω–∞–ª —Å–æ–∑–¥–∞–Ω',
                time: '—Ç–æ–ª—å–∫–æ —á—Ç–æ',
                unread: 0
            });
            
            BeamChat.db.messages[newChannel.id] = [];
            createChannelModal.classList.add('hidden');
            document.getElementById('channelName').value = '';
            document.getElementById('channelDesc').value = '';
            renderChannels();
        });

        document.getElementById('closeGiftModal').addEventListener('click', () => {
            giftModal.classList.add('hidden');
        });

        // ==================== –ù–ê–í–ò–ì–ê–¶–ò–Ø ====================
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => showView(item.dataset.view));
        });

        document.getElementById('profileBtn').addEventListener('click', () => {
            if (!BeamChat.currentUser) {
                authModal.classList.remove('hidden');
            } else {
                showView('settings');
            }
        });

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        setTimeout(() => {
            if (!BeamChat.currentUser) {
                authModal.classList.remove('hidden');
            }
        }, 500);

        updateUI();
        renderMainContent();
    </script>
</body>
</html>